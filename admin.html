<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>لوحة الإدارة - هامش</title>
    <link href="https://fonts.googleapis.com/css2?family=Beiruti:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --color-primary: #FACC15;
            --color-secondary: #38BDF8;
            --color-accent: #EC4899;
            --color-dark-primary: #111827;
            --color-dark-secondary: #1F2937;
            --color-dark-surface: #374151;
            --color-dark-border: #4B5563;
            --color-text-primary: #F9FAFB;
            --color-text-secondary: #D1D5DB;
            --color-text-muted: #9CA3AF;
            --gradient-primary: linear-gradient(135deg, #FACC15 0%, #FB923C 100%);
            --radius-md: 12px;
            --radius-lg: 20px;
            --radius-full: 9999px;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Beiruti', sans-serif;
            background: var(--color-dark-primary);
            color: var(--color-text-primary);
            line-height: 1.6;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            padding: 30px 0;
            background: var(--gradient-primary);
            color: var(--color-dark-primary);
            border-radius: var(--radius-lg);
        }

        .header h1 {
            font-size: 2.5rem;
            font-weight: 800;
            margin-bottom: 10px;
        }

        .admin-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 40px;
        }

        .admin-card {
            background: var(--color-dark-surface);
            border: 2px solid var(--color-dark-border);
            border-radius: var(--radius-lg);
            padding: 30px;
            transition: all 0.3s ease;
        }

        .admin-card:hover {
            border-color: var(--color-primary);
            transform: translateY(-5px);
        }

        .card-title {
            color: var(--color-primary);
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: var(--color-primary);
            font-weight: 600;
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid var(--color-dark-border);
            background: var(--color-dark-secondary);
            color: var(--color-text-primary);
            border-radius: var(--radius-md);
            font-family: inherit;
            transition: border-color 0.3s ease;
        }

        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            outline: none;
            border-color: var(--color-primary);
        }

        .btn {
            background: var(--gradient-primary);
            color: var(--color-dark-primary);
            border: none;
            padding: 12px 24px;
            border-radius: var(--radius-full);
            cursor: pointer;
            font-weight: 700;
            font-family: inherit;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(250, 204, 21, 0.3);
        }

        .btn-danger {
            background: linear-gradient(135deg, #EF4444, #DC2626);
            color: white;
        }

        .btn-secondary {
            background: var(--color-dark-border);
            color: var(--color-text-primary);
        }

        .feature-input, .review-input {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
            align-items: flex-start;
        }

        .feature-input input, .review-input input, .review-input textarea, .review-input select {
            flex: 1;
            margin-bottom: 0;
        }

        .review-input {
            background: var(--color-dark-secondary);
            padding: 15px;
            border-radius: var(--radius-md);
            border: 1px solid var(--color-dark-border);
            margin-bottom: 15px;
        }

        .review-input-row {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
        }

        .review-input-row input {
            flex: 1;
        }

        .review-input-row select {
            width: 120px;
            flex: none;
        }

        .feature-input button, .review-input button {
            padding: 8px 16px;
            font-size: 0.9rem;
        }

        .products-list {
            background: var(--color-dark-surface);
            border: 2px solid var(--color-dark-border);
            border-radius: var(--radius-lg);
            padding: 30px;
        }

        .product-item {
            background: var(--color-dark-secondary);
            border: 1px solid var(--color-dark-border);
            border-radius: var(--radius-md);
            padding: 20px;
            margin-bottom: 15px;
            transition: all 0.3s ease;
        }

        .product-item:hover {
            border-color: var(--color-primary);
            transform: translateX(5px);
        }

        .product-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }

        .product-title {
            color: var(--color-text-primary);
            font-size: 1.25rem;
            font-weight: 700;
        }

        .product-price {
            color: var(--color-primary);
            font-weight: 700;
            font-size: 1.1rem;
        }

        .product-description {
            color: var(--color-text-secondary);
            margin-bottom: 10px;
        }

        .product-category {
            display: inline-block;
            background: var(--color-primary);
            color: var(--color-dark-primary);
            padding: 4px 12px;
            border-radius: var(--radius-full);
            font-size: 0.8rem;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .product-reviews-count {
            color: var(--color-secondary);
            font-size: 0.9rem;
            margin-top: 5px;
        }

        .export-section {
            text-align: center;
            margin-top: 30px;
            padding: 30px;
            background: var(--color-dark-surface);
            border-radius: var(--radius-lg);
            border: 2px solid var(--color-dark-border);
        }

        .code-output {
            background: var(--color-dark-primary);
            border: 2px solid var(--color-dark-border);
            border-radius: var(--radius-md);
            padding: 20px;
            margin: 20px 0;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            max-height: 300px;
            overflow-y: auto;
        }

        .success-message {
            background: linear-gradient(135deg, #10B981, #059669);
            color: white;
            padding: 15px 20px;
            border-radius: var(--radius-md);
            margin: 15px 0;
            text-align: center;
            font-weight: 600;
        }

        .reviews-section {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid var(--color-dark-border);
        }

        .reviews-section h4 {
            color: var(--color-secondary);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        @media (max-width: 768px) {
            .admin-grid {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .container {
                padding: 15px;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .feature-input, .review-input-row {
                flex-direction: column;
                align-items: stretch;
            }

            .review-input-row select {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🛠️ لوحة إدارة المنتجات - هامش</h1>
            <p>أضف وعدّل منتجاتك مع الريفيوهات بسهولة</p>
        </div>

        <div class="admin-grid">
            <!-- نموذج إضافة منتج -->
            <div class="admin-card">
                <h2 class="card-title">
                    ➕ إضافة منتج جديد
                </h2>
                
                <form id="productForm">
                    <div class="form-group">
                        <label>عنوان المنتج:</label>
                        <input type="text" id="title" required placeholder="مثل: Netflix Premium">
                    </div>
                    
                    <div class="form-group">
                        <label>الوصف:</label>
                        <textarea id="description" rows="3" required placeholder="وصف مختصر للمنتج..."></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label>السعر (ر.س):</label>
                        <input type="number" id="price" required placeholder="25">
                    </div>
                    
                    <div class="form-group">
                        <label>السعر الأصلي (اختياري):</label>
                        <input type="number" id="originalPrice" placeholder="45">
                    </div>
                    
                    <div class="form-group">
                        <label>رابط الصورة:</label>
                        <input type="url" id="image" placeholder="https://example.com/image.jpg">
                    </div>
                    
                    <div class="form-group">
                        <label>الفئة:</label>
                        <select id="category" required>
                            <option value="">اختر الفئة</option>
                            <option value="entertainment">🎬 ترفيه</option>
                            <option value="productivity">💼 إنتاجية</option>
                            <option value="ai">🤖 ذكاء اصطناعي</option>
                            <option value="gaming">🎮 ألعاب</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label>المميزات:</label>
                        <div id="features">
                            <div class="feature-input">
                                <input type="text" placeholder="أدخل ميزة للمنتج">
                                <button type="button" class="btn btn-secondary" onclick="addFeature()">إضافة</button>
                            </div>
                        </div>
                    </div>

                    <div class="reviews-section">
                        <h4>
                            ⭐ إضافة تقييمات (اختياري)
                            <small style="font-weight: normal; color: var(--color-text-muted);">- لجعل المنتج أكثر جاذبية</small>
                        </h4>
                        <div id="reviews">
                            <div class="review-input">
                                <div class="review-input-row">
                                    <input type="text" placeholder="اسم المقيم" class="review-author">
                                    <select class="review-rating">
                                        <option value="5">⭐⭐⭐⭐⭐ (5)</option>
                                        <option value="4">⭐⭐⭐⭐ (4)</option>
                                        <option value="3">⭐⭐⭐ (3)</option>
                                        <option value="2">⭐⭐ (2)</option>
                                        <option value="1">⭐ (1)</option>
                                    </select>
                                </div>
                                <textarea placeholder="التعليق..." rows="2" class="review-comment"></textarea>
                                <button type="button" class="btn btn-secondary" onclick="addReview()">إضافة تقييم</button>
                            </div>
                        </div>
                    </div>
                    
                    <button type="submit" class="btn">
                        ✅ إضافة المنتج
                    </button>
                </form>
            </div>

            <!-- معاينة المنتجات -->
            <div class="admin-card">
                <h2 class="card-title">
                    📦 المنتجات الحالية (<span id="productsCount">0</span>)
                </h2>
                
                <div id="currentProducts" style="max-height: 500px; overflow-y: auto;">
                    <!-- سيتم عرض المنتجات هنا -->
                </div>
                
                <div style="margin-top: 20px; text-align: center;">
                    <button class="btn btn-danger" onclick="clearAllProducts()">
                        🗑️ حذف جميع المنتجات
                    </button>
                </div>
            </div>
        </div>

        <!-- قسم التصدير -->
        <div class="export-section">
            <h2 class="card-title" style="justify-content: center;">
                📤 تصدير البيانات
            </h2>
            <p style="color: var(--color-text-secondary); margin-bottom: 20px;">
                انسخ الكود التالي واستبدل به محتوى ملف products.js
            </p>
            
            <button class="btn" onclick="generateCode()">
                🔄 إنشاء الكود
            </button>
            
            <div id="codeOutput" class="code-output" style="display: none;">
                <!-- سيظهر الكود هنا -->
            </div>
            
            <button id="copyBtn" class="btn btn-secondary" onclick="copyCode()" style="display: none;">
                📋 نسخ الكود
            </button>
        </div>
    </div>

    <script>
        let products = JSON.parse(localStorage.getItem('hamishProducts')) || [];
        let nextId = products.length > 0 ? Math.max(...products.map(p => p.id)) + 1 : 1;

        // إضافة حقل ميزة جديد
        function addFeature() {
            const featuresDiv = document.getElementById('features');
            const newFeature = document.createElement('div');
            newFeature.className = 'feature-input';
            newFeature.innerHTML = `
                <input type="text" placeholder="أدخل ميزة للمنتج">
                <button type="button" class="btn btn-danger" onclick="this.parentElement.remove()">حذف</button>
            `;
            featuresDiv.appendChild(newFeature);
        }

        // إضافة حقل تقييم جديد
        function addReview() {
            const reviewsDiv = document.getElementById('reviews');
            const newReview = document.createElement('div');
            newReview.className = 'review-input';
            newReview.innerHTML = `
                <div class="review-input-row">
                    <input type="text" placeholder="اسم المقيم" class="review-author">
                    <select class="review-rating">
                        <option value="5">⭐⭐⭐⭐⭐ (5)</option>
                        <option value="4">⭐⭐⭐⭐ (4)</option>
                        <option value="3">⭐⭐⭐ (3)</option>
                        <option value="2">⭐⭐ (2)</option>
                        <option value="1">⭐ (1)</option>
                    </select>
                </div>
                <textarea placeholder="التعليق..." rows="2" class="review-comment"></textarea>
                <button type="button" class="btn btn-danger" onclick="this.parentElement.remove()">حذف</button>
            `;
            reviewsDiv.appendChild(newReview);
        }

        // إضافة منتج جديد
        document.getElementById('productForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const features = Array.from(document.querySelectorAll('#features input'))
                .map(input => input.value.trim())
                .filter(value => value !== '');
            
            if (features.length === 0) {
                alert('يرجى إضافة ميزة واحدة على الأقل');
                return;
            }

            // جمع التقييمات
            const reviews = [];
            const reviewInputs = document.querySelectorAll('#reviews .review-input');
            
            reviewInputs.forEach(reviewInput => {
                const author = reviewInput.querySelector('.review-author').value.trim();
                const rating = parseInt(reviewInput.querySelector('.review-rating').value);
                const comment = reviewInput.querySelector('.review-comment').value.trim();
                
                if (author && comment) {
                    reviews.push({ author, rating, comment });
                }
            });

            const title = document.getElementById('title').value;
            const imageUrl = document.getElementById('image').value || 
                `https://via.placeholder.com/320x220/1F2937/FACC15?text=${encodeURIComponent(title)}`;
            
            const product = {
                id: nextId++,
                title: title,
                description: document.getElementById('description').value,
                price: document.getElementById('price').value,
                originalPrice: document.getElementById('originalPrice').value || null,
                image: imageUrl,
                category: document.getElementById('category').value,
                features: features,
                reviews: reviews // إضافة التقييمات
            };
            
            products.push(product);
            localStorage.setItem('hamishProducts', JSON.stringify(products));
            
            // إعادة تعيين النموذج
            this.reset();
            document.getElementById('features').innerHTML = `
                <div class="feature-input">
                    <input type="text" placeholder="أدخل ميزة للمنتج">
                    <button type="button" class="btn btn-secondary" onclick="addFeature()">إضافة</button>
                </div>
            `;
            document.getElementById('reviews').innerHTML = `
                <div class="review-input">
                    <div class="review-input-row">
                        <input type="text" placeholder="اسم المقيم" class="review-author">
                        <select class="review-rating">
                            <option value="5">⭐⭐⭐⭐⭐ (5)</option>
                            <option value="4">⭐⭐⭐⭐ (4)</option>
                            <option value="3">⭐⭐⭐ (3)</option>
                            <option value="2">⭐⭐ (2)</option>
                            <option value="1">⭐ (1)</option>
                        </select>
                    </div>
                    <textarea placeholder="التعليق..." rows="2" class="review-comment"></textarea>
                    <button type="button" class="btn btn-secondary" onclick="addReview()">إضافة تقييم</button>
                </div>
            `;
            
            displayProducts();
            showSuccess('تم إضافة المنتج مع التقييمات بنجاح! 🎉');
        });

        // عرض المنتجات
        function displayProducts() {
            const container = document.getElementById('currentProducts');
            const countElement = document.getElementById('productsCount');
            
            countElement.textContent = products.length;
            
            if (products.length === 0) {
                container.innerHTML = `
                    <div style="text-align: center; padding: 40px; color: var(--color-text-muted);">
                        📦 لا توجد منتجات حتى الآن<br>
                        <small>أضف منتجك الأول باستخدام النموذج</small>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = products.map(product => `
                <div class="product-item">
                    <div class="product-header">
                        <div>
                            <div class="product-title">${product.title}</div>
                            <div class="product-category">${getCategoryName(product.category)}</div>
                            ${product.reviews && product.reviews.length > 0 ? 
                                `<div class="product-reviews-count">⭐ ${product.reviews.length} تقييم</div>` : 
                                '<div class="product-reviews-count" style="color: var(--color-text-muted);">لا توجد تقييمات</div>'
                            }
                        </div>
                        <div class="product-price">${product.price} ر.س</div>
                    </div>
                    <div class="product-description">${product.description}</div>
                    <div style="margin-top: 15px;">
                        <button class="btn btn-danger" onclick="deleteProduct(${product.id})">
                            🗑️ حذف
                        </button>
                    </div>
                </div>
            `).join('');
        }

        // الحصول على اسم الفئة
        function getCategoryName(category) {
            const categories = {
                'entertainment': '🎬 ترفيه',
                'productivity': '💼 إنتاجية',
                'ai': '🤖 ذكاء اصطناعي',
                'gaming': '🎮 ألعاب'
            };
            return categories[category] || category;
        }

        // حذف منتج
        function deleteProduct(id) {
            if (confirm('هل أنت متأكد من حذف هذا المنتج؟')) {
                products = products.filter(p => p.id !== id);
                localStorage.setItem('hamishProducts', JSON.stringify(products));
                displayProducts();
                showSuccess('تم حذف المنتج بنجاح');
            }
        }

        // حذف جميع المنتجات
        function clearAllProducts() {
            if (confirm('هل أنت متأكد من حذف جميع المنتجات؟\nهذا الإجراء لا يمكن التراجع عنه!')) {
                products = [];
                nextId = 1;
                localStorage.removeItem('hamishProducts');
                displayProducts();
                showSuccess('تم حذف جميع المنتجات');
            }
        }

        // إنشاء كود JavaScript
        function generateCode() {
            const codeOutput = document.getElementById('codeOutput');
            const copyBtn = document.getElementById('copyBtn');
            
            const jsCode = `// products.js - ملف بيانات المنتجات
const productsData = ${JSON.stringify({products: products}, null, 2)};

// تصدير البيانات للاستخدام في الموقع
if (typeof module !== 'undefined' && module.exports) {
    module.exports = productsData;
}`;
            
            codeOutput.textContent = jsCode;
            codeOutput.style.display = 'block';
            copyBtn.style.display = 'inline-flex';
        }

        // نسخ الكود
        function copyCode() {
            const codeOutput = document.getElementById('codeOutput');
            const textArea = document.createElement('textarea');
            textArea.value = codeOutput.textContent;
            document.body.appendChild(textArea);
            textArea.select();
            document.execCommand('copy');
            document.body.removeChild(textArea);
            
            showSuccess('تم نسخ الكود! الصق الآن في ملف products.js');
        }

        // عرض رسالة نجاح
        function showSuccess(message) {
            const successDiv = document.createElement('div');
            successDiv.className = 'success-message';
            successDiv.textContent = message;
            
            document.body.appendChild(successDiv);
            
            setTimeout(() => {
                successDiv.style.opacity = '0';
                setTimeout(() => {
                    document.body.removeChild(successDiv);
                }, 300);
            }, 3000);
        }

        // تحميل المنتجات عند بدء التشغيل
        displayProducts();
    </script>
</body>
</html>